<% layout('layouts/boilerplate') %>

<div class="container mt-4">
  <h2>Admin Dashboard: All Listings</h2>
  <div style="display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center; margin-bottom:2rem">
    <% allListings.forEach(listing => { %>
      <a href="/admin/listings/<%= listing._id %>" 
         style="
           flex: 1 1 calc(33.333% - 1rem); 
           max-width: 33.333%;
           min-width: 280px;
           text-decoration: none; 
           color: #222;
           border-radius: 20px;
           box-shadow: 0 4px 12px rgba(10, 10, 10, 0.1);
           overflow: hidden;
           display: flex; 
           flex-direction: column; 
           height: 340px;
           margin-bottom:1rem;
           transition: transform 0.3s ease, box-shadow 0.3s ease;
         "
         onmouseover="this.style.transform='translateY(-6px)'; this.style.boxShadow='0 10px 20px rgba(0,0,0,0.15)';"
         onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';"
      >
        <img 
          src="<%= listing.image && listing.image.length > 0 ? listing.image[0].url : '/default.jpg' %>" 
          alt="listing_image" 
          style="width: 100%; height: 180px; object-fit: cover; display: block;"
        >
        <div style="padding: 1rem; flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between;">
          <h5 style="margin: 0 0 0.1rem 0; font-weight: 700; font-size: 1.2rem; line-height: 1.2; color: #111;">
            <%= listing.title %>
          </h5>
          <p style="
            margin: 0 0 0.5rem 0; 
            font-size: 0.9rem; 
            color: #555; 
            overflow: hidden; 
            text-overflow: ellipsis; 
            display: -webkit-box; 
            -webkit-line-clamp: 3; 
            -webkit-box-orient: vertical;
            line-height: 1.2;
            max-height: 3.6em;
          ">
            <%= listing.description %>
          </p>
          <p style="margin: 0; font-weight: 600; font-size: 1.05rem; color: #2a9d8f;">
            &#8377;<%= listing.price ? listing.price.toLocaleString("en-IN") : "Price not available" %> / night
          </p>
        </div>
      </a>
    <% }) %>
  </div>
</div>
